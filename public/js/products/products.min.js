"use strict";const token=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),url="/search",addEventListeners=()=>{const e=document.querySelectorAll("form.option");for(let t=0;t<e.length;t++){let n=e[t],r=n.querySelectorAll("input[name='sort_by"),l=n.querySelectorAll("input[name='genres[]']"),o=n.querySelectorAll("input[name='platform']"),a=n.querySelectorAll("input[name='category']"),c=n.querySelector("input[name='min_price']"),u=n.querySelector("input[name='max_price']");for(let e=0;e<r.length;e++){r[e].addEventListener("click",sendRequest.bind(n,n))}for(let e=0;e<l.length;e++){l[e].addEventListener("click",sendRequest.bind(n,n))}for(let e=0;e<o.length;e++){o[e].addEventListener("click",sendRequest.bind(n,n))}for(let e=0;e<a.length;e++){a[e].addEventListener("click",sendRequest.bind(n,n))}c.addEventListener("keyup",function(){u&&u.value&&c.value&&(u.value<c.value||c<0)&&(c.value=u.value),sendRequest(n)}),u.addEventListener("keyup",function(){c&&c.value&&u.value&&(c.value>u.value||u<0)&&(u.value=c.value),sendRequest(n)})}},sendGet=e=>{let t=encodeForAjax(e);const n={headers:{"Content-Type":"application/json",Accept:"application/json, text-plain, */*","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":token},method:"get",credentials:"same-origin"};return window.history.replaceState("","",window.location.pathname+"?"+t),fetch("api/product?"+t,n).then(e=>e.json()).catch(e=>console.error("Error: "+e))};function loaded(e,t){e.src=t}const sendRequest=e=>{let t=assembleData(e);sendGet(t).then(e=>received(e)).catch(e=>console.error("Error: "+e))},assembleData=e=>{const t=new FormData(e);let n={},r=t.get("sort_by");null!=r&&(n.sort_by=r);let l=t.getAll("genres[]");0!==l.length&&(n.genres=l);let o=t.get("platform");null!=o&&""!==o&&(n.platform=o);let a=t.get("category");null!=a&&""!==a&&(n.category=a);let c=t.get("min_price");c&&(n.min_price=Math.max(0,c));let u=t.get("max_price");return u&&(n.max_price=Math.max(n.min_price,u)),n},received=e=>{(e=>{const t='<div class="row justify-content-between mx-auto flex-wrap">';let n=document.querySelector("#product_list"),r=t;for(let n=0;n<e.length;n++)0!==n&&n%3==0&&(r+="</div>"+t),r+=templateProduct(e[n].name,e[n].url,e[n].image,e[n].price);n.innerHTML=r+"</div>"})(e.products)},templateProduct=(e,t,n,r)=>`<div class="card col-md-3 col-sm-4 col-10 cardProductList my-2 mx-auto">\n                <a href="#"><img class="card-img-top cardProductListImg img-fluid" src="${n}"></a>\n                <div class="card-body">\n                    <h6 class="card-title"> <a href=${t} class="text-decoration-none text-secondary">${e}</a></h6>\n                    <h5 class="cl-orange2">${null!==r?"$"+r:"Unavailable"}</h5>\n                </div>\n            </div>`,encodeForAjax=e=>null==e?null:Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&");function preventDefaultQuerySubmit(){document.getElementById("#query-form")&&document.getElementById("#query-form").addEventListener("submit",function(e){e.preventDefault();let t={};t.query=document.querySelector("form input#query").value,sendGet(t).then(e=>received(e)).catch(e=>console.error("Error: "+e))})}addEventListeners(),preventDefaultQuerySubmit();