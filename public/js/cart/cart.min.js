"use strict";const token=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),cartItemCounter=document.querySelector("#shopping_cart_item_counter"),counter_products_cart=document.querySelector("#counter_products_cart"),url="/cart",table=document.getElementById("tableOffers"),totalPriceDiv=document.getElementById("total-price-div"),cartNoEntries=document.querySelector("#cart-no-entries"),topCheckoutButton=document.querySelector("#checkout-top-button"),totalPrice=document.querySelector("#total_price"),addEventListeners=()=>{document.querySelectorAll(".remove_cart_button").forEach(t=>{t.addEventListener("click",()=>{event.preventDefault();const e=t.getAttribute("data_cart_id"),n=parseFloat(t.getAttribute("value_offer")).toFixed(2);t.disabled=!0,sendDelete(e,n).then(async()=>{let t=await sendGet();totalPrice.innerHTML=t.amount,0===t.amount&&(table.classList.contains("d-none")||(table.className+=" d-none"),cartNoEntries.classList.contains("d-none")&&cartNoEntries.classList.remove("d-none"),totalPriceDiv.classList.contains("d-none")||(totalPriceDiv.className+=" d-none"),topCheckoutButton.classList.contains("d-none")||(topCheckoutButton.className+=" d-none"))})})})},sendGet=t=>{return fetch("/api/getCartTotalPrice",{headers:{"Content-Type":"application/json",Accept:"application/json, text-plain, */*","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":token},method:"get",credentials:"same-origin"}).then(t=>t.json()).catch(t=>console.error("Error: "+t))},sendDelete=(t,e)=>{const n={method:"delete",headers:new Headers({"Content-Type":"application/json",Accept:"application/json, text-plain, */*","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":token})};return fetch(url+"/"+t,n).then(function(n){if(n.json(),n.ok){let n=parseFloat(totalPrice.innerHTML).toFixed(2);n-=e,totalPrice.innerHTML=n.toFixed(2),document.querySelector("#row"+t).remove(),cartItemCounter.innerHTML=cartItemCounter.innerHTML-1,counter_products_cart.innerHTML=counter_products_cart.innerHTML-1}}).catch(t=>console.error("Error:"+t))};document.querySelectorAll(".remove_cart_button").forEach(t=>{t.addEventListener("click",()=>{event.preventDefault();const e=t.getAttribute("data_cart_id"),n=parseFloat(t.getAttribute("value_offer")).toFixed(2);t.disabled=!0,sendDelete(e,n).then(async()=>{let t=await sendGet();totalPrice.innerHTML=t.amount,0===t.amount&&(table.classList.contains("d-none")||(table.className+=" d-none"),cartNoEntries.classList.contains("d-none")&&cartNoEntries.classList.remove("d-none"),totalPriceDiv.classList.contains("d-none")||(totalPriceDiv.className+=" d-none"),topCheckoutButton.classList.contains("d-none")||(topCheckoutButton.className+=" d-none"))})})});